DROP SCHEMA BOOKSTORE;

CREATE SCHEMA IF NOT EXISTS BOOKSTORE;

USE BOOKSTORE;

CREATE TABLE IF NOT EXISTS AUTOR (
	ID_AUTOR INT NOT NULL PRIMARY KEY,
	NOMBRE_AUTOR VARCHAR(50) NOT NULL,
	APELLIDO_AUTOR VARCHAR(50) NOT NULL
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS EDITORIAL (
	ID_EDITORIAL INT NOT NULL PRIMARY KEY,
	NOMBRE_EDITORIAL VARCHAR(50) NOT NULL,
	FOREIGN KEY (ID_EDITORIAL) REFERENCES AUTOR(ID_AUTOR)
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS EDICION (
	ID_LIBRO INT PRIMARY KEY,
	FECHA_RELEASE DATETIME NOT NULL,
    FOREIGN KEY (ID_LIBRO) REFERENCES EDITORIAL(ID_EDITORIAL)
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS LIBRO (
	ID_LIBRO INT NOT NULL,
	NOMBRE_LIBRO VARCHAR(50) UNIQUE NOT NULL,
	FECHA_RELEASE DATETIME NOT NULL,
	VALOR_LIBRO VARCHAR(10),
	PRIMARY KEY (ID_LIBRO),
    FOREIGN KEY (ID_LIBRO) REFERENCES EDICION(ID_LIBRO),
	FOREIGN KEY (ID_LIBRO) REFERENCES AUTOR(ID_AUTOR)
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS COMPRA (
	ID_CLIENTE INT NOT NULL PRIMARY KEY,
	NOMBRE_CLIENTE TEXT(50),
	APRELLIDO_CLIENTE TEXT(50),
	ID_DOC INT,
	NOMBRE_DOC VARCHAR(30) UNIQUE NOT NULL,
	DOMICILIO VARCHAR(50) NOT NULL,
	ID_CIUDAD INT NOT NULL,
	COD_POSTAL INT NOT NULL,
	CEL_NUM INT NOT NULL,
	EMAIL TEXT(50),
	FOREIGN KEY (ID_DOC) REFERENCES LIBRO(ID_LIBRO)
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS DOC (
	ID_DOC INT NOT NULL PRIMARY KEY,
	NOMBRE_DOC VARCHAR(30) UNIQUE NOT NULL,
	FOREIGN KEY (ID_DOC) REFERENCES COMPRA(ID_CLIENTE),
    FOREIGN KEY (ID_DOC) REFERENCES LIBRO(ID_LIBRO)
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS FACTURACION (
	NRO_FACTURA VARCHAR(50) PRIMARY KEY,
	ID_CLIENTE INT NOT NULL,
	ID_MEDIOPAGO INT NOT NULL,
	FECHA_COMPRA DATETIME NOT NULL,
	FOREIGN KEY (ID_CLIENTE) REFERENCES COMPRA(ID_CLIENTE),
	FOREIGN KEY (ID_MEDIOPAGO) REFERENCES Compra(ID_CLIENTE)
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS DETALLE_FC (
	ID_LIBRO INT NOT NULL PRIMARY KEY,
	NOMBRE_LIBRO VARCHAR(50) NOT NULL,
	NRO_FACTURA VARCHAR(50) NOT NULL,
	ID_EDITORIAL INT NOT NULL,
	VALOR_LIBRO VARCHAR(10) NOT NULL,
	CANTIDAD INT NOT NULL,
	FECHA_COMPRA DATETIME NOT NULL,
FOREIGN KEY (NOMBRE_LIBRO) REFERENCES FACTURACION(NRO_FACTURA),
FOREIGN KEY (NRO_FACTURA) REFERENCES FACTURACION(NRO_FACTURA)
)ENGINE = InnoDB;
